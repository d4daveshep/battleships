{# Shots Fired Board Component - Shows past shots and allows aiming new shots #}
<div class="shots-fired-board-wrapper" id="shots-fired-board-wrapper" data-testid="shots-fired-board-wrapper">
    <table data-testid="shots-fired-board" class="ship-grid ship-grid--aiming">
        <thead>
            <tr>
                <th></th>
                {% for col in range(1, 11) %}
                <th>{{ col }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% set rows = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'] %}
            {% for row in rows %}
            <tr>
                <th>{{ row }}</th>
                {% for col in range(1, 11) %}
                    {% set coord = row ~ col %}
                    {% set is_aimed = coord in aimed_shots %}
                    {% set is_fired = coord in shots_fired %}
                    {% set is_available = not is_aimed and not is_fired and aimed_count < shots_available %}
                    {% set is_unavailable = not is_aimed and not is_fired and aimed_count >= shots_available %}
                    
                    <td data-testid="shots-fired-cell-{{ coord }}"
                        data-coord="{{ coord }}"
                        class="ship-grid-cell 
                               {% if is_aimed %}cell--aimed{% endif %}
                               {% if is_fired %}cell--fired{% endif %}
                               {% if is_available %}cell--available{% endif %}
                               {% if is_unavailable %}cell--unavailable{% endif %}"
                        {% if is_available %}
                        hx-post="/game/{{ game_id }}/aim-shot"
                        hx-vals='{"coord": "{{ coord }}"}'
                        hx-target="#aiming-interface"
                        hx-swap="innerHTML"
                        role="button"
                        tabindex="0"
                        aria-label="Aim at {{ coord }}"
                        {% else %}
                        aria-disabled="true"
                        {% endif %}>
                        {% if is_fired %}
                            <span class="cell-marker cell-marker--fired" aria-label="Fired in round {{ shots_fired[coord] }}">{{ shots_fired[coord] }}</span>
                        {% elif is_aimed %}
                            <span class="cell-marker cell-marker--aimed" aria-label="Aimed">‚óè</span>
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
